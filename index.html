<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
        <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
        <script>
            const latArray = [34.02055611]
            const longArray = [-118.303161]
            const idArray = ["#text1"]
            // const imgArray ["assets/asset.jpeg"]
            const locNameArray = ["Chris's House"]
            function getDistance(lat1, lon1, lat2, lon2) {
              const R = 6371; // Radius of the earth in km
              const dLat = deg2rad(lat2 - lat1); // deg2rad below
              const dLon = deg2rad(lon2 - lon1); 
              const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * 
                Math.sin(dLon/2) * Math.sin(dLon/2)
                ; 
              const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
              const d = R * c; // Distance in km
              return d;
            }

            function deg2rad(deg) {
              return deg * (Math.PI/180)
            }
          function updateDistance() {
            if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(function(position) {
                var latitude = position.coords.latitude;
                var longitude = position.coords.longitude;
                console.log("Latitude: " + latitude + ", Longitude: " + longitude);
                lat = latArray[0]
                long = longArray[0]
                console.log(lat); // Output: "34.02055611"
                console.log(long); // Output: "-118.303161"

                distance = getDistance(latitude,longitude,lat,long)*1000
                console.log(distance)
                document.querySelector(idArray[0]).setAttribute("value", `${locNameArray[0]} Distance: ${distance.toFixed(2)}m`);
              });
            } else {
              console.log("Geolocation is not supported by this browser.");
            }
          }
          setInterval(updateDistance, 1000);
        </script>
    </head>

   <body style="margin: 0; overflow: hidden;">
        <div style="height: 100px; background: white; border: 5px solid;margin: auto; width: 50%; padding: 10px;">
            <h3 style="text-align: center;">Smorgasburg VR Experience</h3>
        </div>
        <div id="myEmbeddedScene" style="height: 60vh">
            <!-- loading-screen="dotsColor: red; backgroundColor: black" -->
            <a-scene embedded loading-screen="enabled: false;"
            arjs="sourceType: webcam; debugUIEnabled: false;"
            >
                <a-image
                    src="assets/asset.jpeg"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 34.0346104; longitude: -118.2416855;"
                ></a-image>
                <a-image
                    src="assets/asset.jpeg"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 34.034942; longitude: -118.241651;"
                ></a-image>
                <a-image
                    src="assets/asset.jpeg"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 34.035375; longitude: -118.241322;"
                ></a-image>
                <a-image
                    src="assets/asset.jpeg"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 34.03563; longitude: -118.2414;"
                ></a-image>
                <a-image
                    src="assets/asset.jpeg"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 34.035394; longitude: -118.241746;"
                ></a-image>
                <a-image
                    src="assets/asset.jpeg"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 34.03527; longitude: -118.241627;"
                ></a-image>
                <a-image
                    src="assets/asset.jpeg"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 34.034983; longitude: -118.241988;"
                ></a-image>
                <a-image
                    src="assets/asset.jpeg"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 34.034826; longitude: -118.241955;"
                ></a-image>
                <a-image
                    src="assets/asset.jpeg"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 34.034561; longitude: -118.242386;"
                ></a-image>
                <a-image
                    src="assets/asset.jpeg"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 34.034462; longitude: -118.241899;"
                ></a-image>
                <a-image
                    src="assets/asset.jpeg"
                    position="0 0 0 "
                    look-at="[gps-camera]"
                    scale="5 5 5"
                    gps-entity-place="latitude: 34.02055611; longitude: -118.303161;"
                ></a-image>
                <a-text
                    id = "text1"
                    value="Distance: 100m"
                    position="15 0 0"
                    color = "black"
                    scale = "2 2 2"
                    look-at="[gps-camera]"
                    gps-entity-place="latitude: 34.02055611; longitude: -118.303161;"
                ></a-text>
            <a-camera gps-camera rotation-reader></a-camera>
        </a-scene>
        </div>
    </body>
</html>